## 1. 产品概述
对现有 Web 聊天应用进行 4 项 UI/UX 优化：移除对话历史 hover 放大、加入回复等待动画、输入栏加号背景透明、代码块美化并显示语言标签。目标是提升视觉一致性、减少不确定等待感、增强代码可读性。

## 2. 核心功能

### 2.2 功能模块
我们的聊天应用本次优化聚焦以下页面与模块：
1. **聊天页**：侧栏对话历史（去除 hover 放大/浮动）、消息区（显示代码块语言标签）、输入区（加号背景透明）、等待动画（模型回复中）。

### 2.3 页面详情
| Page Name | Module Name | Feature description |
|-----------|-------------|---------------------|
| 聊天页 | 侧栏对话历史 | 移除 hover 放大/浮动效果；保持静态尺寸与轻微背景色变化，避免误导性动效。 |
| 聊天页 | 模型回复等待动画 | 在调用模型到接收首个 token 期间显示轻量动画（3 点脉冲/旋转），在回复结束后隐藏。考虑取消/错误时停止动画。 |
| 聊天页 | 输入栏加号按钮 | 背景改为 transparent；保留边框/图标颜色，hover 仅改变图标/边框色，不改变尺寸。 |
| 聊天页 | 代码块美化 | 代码区采用现代暗色主题与等宽字体；顶部显示语言标签（JSON/bash/python 等），支持横向滚动与高对比行号。 |

## 3. 核心流程
- 用户在聊天页输入消息并发送。
- 前端进入“等待模型回复”状态：显示加载动画；当收到回复或错误时隐藏动画。
- 若回复包含代码块：以美化样式渲染，并在顶部显示语言标签；否则按普通文本渲染。

```mermaid
graph TD
  "A 输入消息" --> "B 等待模型回复?"
  "B 等待模型回复?" -->|是| "C 显示加载动画"
  "B 等待模型回复?" -->|否| "D 正常交互"
  "C 显示加载动画" --> "E 收到回复或错误"
  "E 收到回复或错误" --> "F 隐藏动画"
  "F 隐藏动画" --> "G 是否含代码块?"
  "G 是否含代码块?" -->|是| "H 美化渲染并显示语言标签"
  "G 是否含代码块?" -->|否| "I 普通文本渲染"
```

## 4. 用户界面设计
### 4.1 设计风格
- 颜色：主内容浅灰 (#f5f5f5)、侧栏深灰 (#1f1f1f)；强调色为品牌蓝（rgba(59,130,246,0.6)）。
- 按钮：圆角 6px，扁平化；hover 仅颜色加深，不改变尺寸。
- 字体：系统 sans-serif；代码块使用 Monaco/Menlo 等等宽字体，字号 13–14px。
- 布局：顶部导航 + 左侧对话历史侧栏 + 右侧消息主区；卡片化消息样式。
- 图标：线性风格，颜色随状态变化（正常 60% 透明度，hover 80%）。

### 4.2 页面设计总览
| Page Name | Module Name | UI Elements |
|-----------|-------------|-------------|
| 聊天页 | 侧栏历史项 | 移除 transform: scale/translate；保留背景色轻微变化（#222→#2a2a2a）。 |
| 聊天页 | 等待动画 | 3 点脉冲或旋转圆环；颜色为品牌蓝；居中或贴近输入区上方；动画时机与状态一致。 |
| 聊天页 | 加号按钮 | 背景 transparent；边框 1px rgba(59,130,246,0.4)；图标 color 同色系；hover 仅颜色加深。 |
| 聊天页 | 代码块 | 顶部语言标签栏（28px，高对比）；代码区暗色主题（#1e1e1e）；行号栏 #282828；横向滚动。 |

### 4.3 响应式
桌面优先，移动端自适应：
- 侧栏可折叠；代码块支持横向滚动与断行。
- 触控优化：加号按钮点击区域不小于 40×40px。